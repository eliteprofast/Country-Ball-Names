<!-- #file:gravity-game.html -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Maths Learning Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #02fdfd;
            text-align: center;
        }

        #game-container {
            background: #c8ff02;
            padding: 30px;
            margin: 50px auto;
            width: 350px;
            border-radius: 10px;
            box-shadow: 0 2px 8px #ccc;
        }

        #question {
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        #result {
            margin-top: 15px;
            font-weight: bold;
        }

        input[type="number"] {
            font-size: 1em;
            padding: 5px;
            width: 80px;
        }

        button {
            font-size: 1em;
            padding: 7px 20px;
            margin-top: 10px;
        }
    </style>
</head>

<body class="bg-light d-flex flex-column min-vh-100">
  <nav style="width:100vw;position:fixed;top:0;left:0;z-index:1000;background:#10b981;color:#fff;box-shadow:0 2px 8px #10b98122;display:flex;align-items:center;justify-content:center;height:54px;">
    <a href="index.html" style="color:#fff;font-weight:bold;font-size:1.1em;text-decoration:none;padding:0 24px;transition:background 0.2s;">Country Name Hunt</a>
    <a href="logo-guess.html" style="color:#fff;font-weight:bold;font-size:1.1em;text-decoration:none;padding:0 24px;transition:background 0.2s;">Logo Guess Game</a>
    <a href="maths-learning-system.html" style="color:#fff;font-weight:bold;font-size:1.1em;text-decoration:none;padding:0 24px;transition:background 0.2s;">Maths Learning Game</a>
    <a href="english-reading-system.html" style="color:#fff;font-weight:bold;font-size:1.1em;text-decoration:none;padding:0 24px;transition:background 0.2s;">English Reading</a>
    <a href="Rock-Paper-Scissors.html" style="color:#fff;font-weight:bold;font-size:1.1em;text-decoration:none;padding:0 24px;transition:background 0.2s;">Rock Paper Scissors</a>
    <a href="DragonType.html" style="color:#fff;font-weight:bold;font-size:1.1em;text-decoration:none;padding:0 24px;transition:background 0.2s;">Dragon Type</a>
    <a href="gravity-game.html" style="color:#fff;font-weight:bold;font-size:1.1em;text-decoration:none;padding:0 24px;transition:background 0.2s;">Gravity Game</a>
  </nav>
  <div id="coinDisplayTopLeft" style="position:fixed;top:64px;left:24px;z-index:2000;font-size:18px;color:#f59e42;font-weight:600;letter-spacing:0.5px;background:#fff8;backdrop-filter:blur(2px);padding:6px 18px 6px 14px;border-radius:18px;box-shadow:0 2px 8px #10b98122;">
    Coins: <span id="coinCountTopLeft">0</span>
  </div>
  <div style="height:54px;"></div>
    <button id="stickerLibraryBtn"
        style="position:fixed;top:64px;right:24px;background:#fffbe6;color:#10b981;font-weight:bold;border:2px solid #10b981;border-radius:18px;padding:8px 18px;box-shadow:0 2px 8px #f59e4222;cursor:pointer;z-index:2001;">Your-Sticker-Library</button>

    <div id="stickerLibraryModal"
        style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);z-index:100;align-items:center;justify-content:center;">
        <div id="stickerLibraryContent"
            style="background:#fffbe6;padding:24px 32px;border-radius:16px;box-shadow:0 2px 16px #f59e4222;min-width:220px;max-width:90vw;position:relative;display:flex;flex-direction:column;align-items:center;">
            <button id="closeStickerLibrary"
                style="position:absolute;top:8px;right:12px;background:none;border:none;font-size:1.5em;color:#10b981;cursor:pointer;">&times;</button>
            <div style="font-weight:bold;font-size:1.2em;color:#10b981;margin-bottom:12px;">Your Equipped Sticker</div>
            <div id="equippedStickerDisplay" style="font-size:2.5em;margin-bottom:8px;"></div>
            <div id="equippedStickerName" style="font-size:1.1em;color:#555;"></div>
            <!-- Pick a Sticker and sticker options removed from library modal -->
        </div>
    </div>
    <div id="game-container">
        <div id="question"></div>
        <div style="display:flex;gap:10px;justify-content:center;align-items:center;margin-bottom:10px;">
            <input type="number" id="answer" autocomplete="off" style="flex:1;max-width:100px;"
                placeholder="Your answer" />
            <button id="submitBtn" onclick="submitAnswer()"
                style="background:#10b981;color:#fff;border:none;border-radius:6px;box-shadow:0 2px 8px #10b98122;transition:background 0.2s;"
                tabindex="-1">Enter</button>
            <button id="skipBtn" type="button"
                style="background:#f59e42;color:#fff;border:none;border-radius:6px;box-shadow:0 2px 8px #f59e4222;transition:background 0.2s;">Skip</button>
        </div>
        <div id="result" style="min-height:28px;"></div>
        <div id="coins"
        style="margin:70px 0 0 0;font-size:1.18em;color:#f59e42;font-weight:bold;display:flex;align-items:center;justify-content:center;gap:0.5em;background:#fffbe6;padding:8px 18px;border-radius:18px;box-shadow:0 2px 8px #f59e4222;max-width:180px;margin-left:auto;margin-right:auto;">
            <img src="https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/1fa99.png" alt="coin"
                style="height:1.4em;width:1.4em;vertical-align:middle;">
            <span id="coinCount">0</span>
        </div>
        <div id="rewardList"
            style="margin:18px 0 0 0; display:none; flex-direction:column; align-items:center; background:#fffbe6; border-radius:12px; box-shadow:0 2px 8px #f59e4222; padding:12px 18px; max-width:260px; margin-left:auto; margin-right:auto;">
            <div style="font-weight:bold; color:#10b981; margin-bottom:8px;">üéÅ Reward! Pick a sticker:</div>
            <div id="rewardOptions" style="display:flex; gap:10px; flex-wrap:wrap; justify-content:center;"></div>
        </div>

    </div>
    <script>
        let num1, num2, operator, correctAnswer;
        let coins = Number(localStorage.getItem('mathCoins') || 0);

        function skipQuestion() {
            document.getElementById('result').textContent = `Skipped! The answer was ${correctAnswer}.`;
            document.getElementById('result').style.color = '#f59e42';
            setTimeout(generateQuestion, 2000);
        }

        // Attach skipQuestion to skipBtn click after DOM is loaded
        window.addEventListener('DOMContentLoaded', function () {
            document.getElementById('skipBtn').addEventListener('click', skipQuestion);
        });

        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function updateCoins() {
            document.getElementById('coinCount').textContent = coins;
            localStorage.setItem('mathCoins', coins);
            // Also update the top left coin display if it exists
            var coinCountTopLeft = document.getElementById('coinCountTopLeft');
            if (coinCountTopLeft) {
                coinCountTopLeft.textContent = coins;
            }
        }

        function generateQuestion() {
            // Show sticker library only once (first time coins >= 2 or coins % 5 === 0 and not shown before)
            if (!localStorage.getItem('stickerRewardShown')) {
                if ((coins === 2 || coins % 5 === 0) && coins > 0) {
                    localStorage.setItem('stickerRewardShown', '1');
                    showRewardList();
                    return;
                }
            }
            // Easier questions: only + and - operators, numbers 1-10
            const ops = ['+', '-'];
            num1 = randomInt(1, 10);
            num2 = randomInt(1, 10);
            operator = ops[randomInt(0, ops.length - 1)];
            if (operator === '-' && num2 > num1) [num1, num2] = [num2, num1];
            let displayOperator = operator;
            correctAnswer = eval(`${num1} ${operator} ${num2}`);
            document.getElementById('question').textContent = `What is ${num1} ${displayOperator} ${num2}?`;
            document.getElementById('answer').value = '';
            document.getElementById('answer').focus();
            document.getElementById('result').textContent = '';
            updateCoins();
        }

        function submitAnswer() {
            const userAnswer = Number(document.getElementById('answer').value);
            if (userAnswer === correctAnswer) {
                coins++;
                updateCoins();
                animateCoin();
                document.getElementById('result').textContent = 'Correct!';
                document.getElementById('result').style.color = 'green';
                // Only show sticker reward if not already shown
                if (!localStorage.getItem('stickerRewardShown')) {
                    if (coins === 1 || coins % 5 === 0) {
                        localStorage.setItem('stickerRewardShown', '1');
                        showRewardList();
                        return;
                    }
                }
            } else {
                document.getElementById('result').textContent = `Wrong! The answer was ${correctAnswer}.`;
                document.getElementById('result').style.color = 'red';
            }
            setTimeout(generateQuestion, 2000);
        }

        // Sticker list (global, so both reward and library can use)
        const stickers = [
            { label: 'üê∂', name: 'Dog' },
            { label: 'üê±', name: 'Cat' },
            { label: 'ü¶Ñ', name: 'Unicorn' },
            { label: 'üêº', name: 'Panda' },
            { label: 'üêß', name: 'Penguin' },
            { label: 'ü¶ä', name: 'Fox' },
            { label: 'üê∏', name: 'Frog' },
            { label: 'üêµ', name: 'Monkey' },
            { label: 'üêØ', name: 'Tiger' },
            { label: 'ü¶Å', name: 'Lion' }
        ];

        function showRewardList() {
            const rewardList = document.getElementById('rewardList');
            const rewardOptions = document.getElementById('rewardOptions');
            rewardOptions.innerHTML = '';
            stickers.forEach(sticker => {
                const btn = document.createElement('button');
                btn.innerHTML = `<span style="font-size:2em;">${sticker.label}</span><br><span style="font-size:0.9em;">${sticker.name}</span>`;
                btn.style.background = '#fff';
                btn.style.color = '#10b981';
                btn.style.border = '2px solid #10b981';
                btn.style.borderRadius = '10px';
                btn.style.padding = '8px 10px';
                btn.style.fontSize = '1em';
                btn.style.cursor = 'pointer';
                btn.style.display = 'flex';
                btn.style.flexDirection = 'column';
                btn.style.alignItems = 'center';
                btn.style.justifyContent = 'center';
                btn.style.minWidth = '54px';
                btn.style.margin = '2px';
                btn.onclick = function () {
                    rewardList.style.display = 'none';
                    // Save equipped sticker to localStorage
                    localStorage.setItem('equippedSticker', JSON.stringify(sticker));
                    document.getElementById('result').textContent = `You picked: ${sticker.label} ${sticker.name}`;
                    document.getElementById('result').style.color = '#10b981';
                    setTimeout(generateQuestion, 2000);
                };
                rewardOptions.appendChild(btn);
            });
            rewardList.style.display = 'flex';
            document.getElementById('answer').blur();
        }
        // Sticker Library Modal logic
        document.getElementById('stickerLibraryBtn').onclick = function () {
            const modal = document.getElementById('stickerLibraryModal');
            const equipped = JSON.parse(localStorage.getItem('equippedSticker') || 'null');
            const display = document.getElementById('equippedStickerDisplay');
            const name = document.getElementById('equippedStickerName');
            if (equipped) {
                display.textContent = equipped.label;
                name.textContent = equipped.name;
            } else {
                display.textContent = '‚ùì';
                name.textContent = 'No sticker equipped yet!';
            }
            // Show all stickers to pick from (fix: ensure the container exists)
            let options = document.getElementById('libraryStickerOptions');
            if (!options) {
                // If the container is missing, create and append it
                options = document.createElement('div');
                options.id = 'libraryStickerOptions';
                options.style.display = 'flex';
                options.style.gap = '10px';
                options.style.flexWrap = 'wrap';
                options.style.justifyContent = 'center';
                document.getElementById('stickerLibraryContent').appendChild(options);
            }
            options.innerHTML = '';
            stickers.forEach(sticker => {
                const btn = document.createElement('button');
                btn.innerHTML = `<span style="font-size:2em;">${sticker.label}</span><br><span style="font-size:0.9em;">${sticker.name}</span>`;
                btn.style.background = '#fff';
                btn.style.color = '#10b981';
                btn.style.border = '2px solid #10b981';
                btn.style.borderRadius = '10px';
                btn.style.padding = '8px 10px';
                btn.style.fontSize = '1em';
                btn.style.cursor = 'pointer';
                btn.style.display = 'flex';
                btn.style.flexDirection = 'column';
                btn.style.alignItems = 'center';
                btn.style.justifyContent = 'center';
                btn.style.minWidth = '54px';
                btn.style.margin = '2px';
                btn.onclick = function () {
                    localStorage.setItem('equippedSticker', JSON.stringify(sticker));
                    display.textContent = sticker.label;
                    name.textContent = sticker.name;
                };
                options.appendChild(btn);
            });
            modal.style.display = 'flex';
        };

        document.getElementById('closeStickerLibrary').onclick = function () {
            document.getElementById('stickerLibraryModal').style.display = 'none';
        };

        // Also close modal if user clicks outside the modal content
        document.getElementById('stickerLibraryModal').addEventListener('mousedown', function (e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });

        document.getElementById('answer').addEventListener('keydown', function (e) {
            if (e.key === 'Enter' && !document.getElementById('submitBtn').disabled) {
                e.preventDefault();
                submitAnswer();
            } else if ((e.key === 'Escape' || e.key === 'Esc') && !document.getElementById('skipBtn').disabled) {
                e.preventDefault();
                skipQuestion();
            }
        });

        // Hide reward list and continue if user clicks outside
        document.addEventListener('mousedown', function (e) {
            const rewardList = document.getElementById('rewardList');
            if (rewardList.style.display === 'flex' && !rewardList.contains(e.target)) {
                rewardList.style.display = 'none';
                setTimeout(generateQuestion, 200);
            }
        });

        // Focus input on page click for mobile
        document.body.addEventListener('click', function (e) {
            if (e.target.id !== 'answer') {
                document.getElementById('answer').focus();
            }
        });

        // Animate coin on earn
        function animateCoin() {
            const coin = document.getElementById('coinCount');
            coin.style.transform = 'scale(1.3)';
            coin.style.transition = 'transform 0.18s';
            setTimeout(() => {
                coin.style.transform = 'scale(1)';
            }, 180);
        }



        // On page load, sync the top left coin display
        window.addEventListener('DOMContentLoaded', function () {
            var coinCountTopLeft = document.getElementById('coinCountTopLeft');
            if (coinCountTopLeft) {
                coinCountTopLeft.textContent = coins;
            }
        });
        generateQuestion();
    </script>
</body>

</html>